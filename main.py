from cmd import Cmd
import threading
import sys,time
import listener
from controller import controller

class terminal(Cmd):

	intro = "Listening on port 8000"
	prompt = "$console > "

	def default(self,args):
		controller.fileWrite(args)
		time.sleep(4)

# threading listener server
thread = threading.Thread(target=listener.run,args=(''))
thread.daemon=True
thread.start()


if len(sys.argv) == 2:
	try:
		controller = controller(sys.argv[1])
		# terminal stuffs
		terminal = terminal()
		terminal.cmdloop()
	except KeyboardInterrupt:
		print(" \nexiting!")
else:
	print("You did not specify the listen IP as argument!")
	print("Usage: python3 main.py 10.10.11.89")
